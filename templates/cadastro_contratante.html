{% extends "base_simples.html" %}

{% block conteudo %}
<form id="formContratante" class="cadastro-form" method="post" action="/cadastro_contratante">
    <div class="form-section">
        <h3 class="section-title">
            <i class="bi bi-person-fill"></i>
            Dados Pessoais
        </h3>

        <div class="row">
            <div class="col-md-8">
                <label for="nome" class="form-label">Nome Completo</label>
                <input type="text" class="form-control" id="nome" name="nome" required>
            </div>
            <div class="col-md-4">
                <label for="dataNascimento" class="form-label">Data de Nascimento</label>
                <input type="date" class="form-control" id="dataNascimento" name="dataNascimento" required>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email" required>
            </div>
            <div class="col-md-3">
                <label for="telefone" class="form-label">Telefone/WhatsApp</label>
                <input type="tel" class="form-control" id="telefone" name="telefone" placeholder="(00) 00000-0000"
                    required>
            </div>
            <div class="col-md-3">
                <label for="cpf" class="form-label">CPF</label>
                <input type="text" class="form-control" id="cpf" name="cpf" placeholder="000.000.000-00" required>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <label for="relacao" class="form-label">Relação com a pessoa a ser cuidada</label>
                <select class="form-select" id="relacao" name="parentesco_paciente" required>
                    <option value="">Selecione...</option>
                    <option value="filho">Filho(a)</option>
                    <option value="conjuge">Cônjuge</option>
                    <option value="neto">Neto(a)</option>
                    <option value="irmao">Irmão(ã)</option>
                    <option value="sobrinho">Sobrinho(a)</option>
                    <option value="responsavel">Responsável Legal</option>
                    <option value="proprio">Eu mesmo(a)</option>
                    <option value="outro">Outro</option>
                </select>
            </div>
            <div class="col-md-6" id="outroRelacaoDiv" style="display: none;">
                <label for="outroRelacao" class="form-label">Especifique a relação</label>
                <input type="text" class="form-control" id="outroRelacao" name="outroRelacao">
            </div>
        </div>
    </div>

    <div class="form-section">
        <h3 class="section-title">
            <i class="bi bi-geo-alt-fill"></i>
            Localização
        </h3>

        <div class="row">
            <div class="col-md-3">
                <label for="cep" class="form-label">CEP</label>
                <input type="text" class="form-control" id="cep" name="cep" placeholder="00000-000" required>
            </div>
            <div class="col-md-6">
                <label for="endereco" class="form-label">Endereço</label>
                <input type="text" class="form-control" id="endereco" name="logradouro" required>
            </div>
            <div class="col-md-3">
                <label for="numero" class="form-label">Número</label>
                <input type="text" class="form-control" id="numero" name="numero">
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <label for="bairro" class="form-label">Bairro</label>
                <input type="text" class="form-control" id="bairro" name="bairro" required>
            </div>
            <div class="col-md-4">
                <label for="cidade" class="form-label">Cidade</label>
                <input type="text" class="form-control" id="cidade" name="cidade" required>
            </div>
            <div class="col-md-4">
                <label for="estado" class="form-label">Estado</label>
                <input type="text" class="form-control" id="estado" name="estado" required>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="localAtendimento" name="localAtendimento">
                    <label class="form-check-label" for="localAtendimento">
                        O atendimento será no endereço informado acima
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="form-section">
        <h3 class="section-title">
            <i class="bi bi-lock-fill"></i>
            Segurança da Conta
        </h3>

        <div class="row">
            <div class="col-md-6">
                <label for="senha" class="form-label">Senha</label>
                <input type="password" class="form-control" id="senha" name="senha" required>
                <small class="form-text">Mínimo 8 caracteres</small>
            </div>
            <div class="col-md-6">
                <label for="confirmarSenha" class="form-label">Confirmar Senha</label>
                <input type="password" class="form-control" id="confirmarSenha" name="confirmarSenha" required>
            </div>
        </div>
    </div>

    <div class="form-section">
        <div class="termos-area">
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="termos" name="termos" required>
                <label class="form-check-label" for="termos">
                    Li e aceito os <a href="#" class="link-termos">Termos de Uso</a> e a <a href="#"
                        class="link-termos">Política de Privacidade.</a>
                </label>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="comunicacoes" name="comunicacoes">
                <label class="form-check-label" for="comunicacoes">
                    Aceito receber sugestões de cuidadores e comunicações da plataforma.
                </label>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="compartilharDados" name="compartilharDados">
                <label class="form-check-label" for="compartilharDados">
                    Autorizo o compartilhamento das minhas necessidades com cuidadores qualificados.
                </label>
            </div>
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn-criar-conta">
            <i class="bi bi-check-circle"></i>
            Criar Minha Conta
        </button>
        <p class="login-link">
            Já tem conta? <a href="/login">Faça login aqui</a>
        </p>
    </div>
</form>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>

    document.getElementById('telefone').addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length <= 11) {
            value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
        }
        e.target.value = value;
    });


    document.getElementById('cpf').addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        e.target.value = value;
    });


    document.getElementById('cep').addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
        e.target.value = value;
    });

    document.getElementById('relacao').addEventListener('change', function () {
        const outroDiv = document.getElementById('outroRelacaoDiv');
        const outroInput = document.getElementById('outroRelacao');

        if (this.value === 'outro') {
            outroDiv.style.display = 'block';
            outroInput.required = true;
        } else {
            outroDiv.style.display = 'none';
            outroInput.required = false;
            outroInput.value = '';
        }
    });


    document.getElementById('orcamentoMin').addEventListener('blur', function () {
        const min = parseFloat(this.value);
        const maxInput = document.getElementById('orcamentoMax');
        const max = parseFloat(maxInput.value);

        if (min && max && min >= max) {
            alert('O orçamento mínimo deve ser menor que o máximo');
            this.focus();
        }
    });

    document.getElementById('orcamentoMax').addEventListener('blur', function () {
        const max = parseFloat(this.value);
        const minInput = document.getElementById('orcamentoMin');
        const min = parseFloat(minInput.value);

        if (min && max && min >= max) {
            alert('O orçamento máximo deve ser maior que o mínimo');
            this.focus();
        }
    });


    document.getElementById('confirmarSenha').addEventListener('blur', function () {
        const senha = document.getElementById('senha').value;
        const confirmarSenha = this.value;

        if (senha !== confirmarSenha) {
            this.setCustomValidity('As senhas não coincidem');
        } else {
            this.setCustomValidity('');
        }
    });


    // document.getElementById('formContratante').addEventListener('submit', function (e) {
    //     e.preventDefault();

    //     alert('Formulário enviado! (implementar integração com backend)');
    // });
</script>
<link rel="stylesheet" href="/static/css/cadastro_contratante.css">
{% endblock %}