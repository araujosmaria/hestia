{% extends "base_simples.html" %}

{% block conteudo %}
<body class="editar-perfil-page">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person"></i> João Silva
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/perfil">Meu Perfil</a></li>
                            <li><a class="dropdown-item" href="/configuracoes">Configurações</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/logout">Sair</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="profile-container">
            <!-- Header do Perfil -->
            <div class="profile-header">
                <div class="row align-items-center">
                    <div class="col-md-3 text-center">
                        <div class="profile-photo-container">
                            <img src="/static/img/default-avatar.jpg" alt="Foto do perfil" class="profile-photo" id="fotoPerfilPreview">
                            <div class="photo-overlay">
                                <i class="bi bi-camera-fill"></i>
                                <span>Alterar Foto</span>
                            </div>
                            <input type="file" id="novaFotoPerfil" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="profile-info">
                            <h2 class="profile-name">João Silva Santos</h2>
                            <p class="profile-title">Cuidador Profissional</p>
                            <div class="profile-stats">
                                <div class="stat-item">
                                    <span class="stat-number">4.8</span>
                                    <span class="stat-label">Avaliação</span>
                                    <div class="stars">
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">15</span>
                                    <span class="stat-label">Atendimentos</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">5</span>
                                    <span class="stat-label">Anos de Experiência</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Formulário de Edição -->
            <div class="profile-content">
                <form id="formEditarPerfil" class="edit-form">
                    <!-- Dados Pessoais -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-person-fill"></i>
                                Dados Pessoais
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="pessoais">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-pessoais">
                            <div class="row">
                                <div class="col-md-8">
                                    <label for="nome" class="form-label">Nome Completo *</label>
                                    <input type="text" class="form-control" id="nome" value="João Silva Santos" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="dataNascimento" class="form-label">Data de Nascimento *</label>
                                    <input type="date" class="form-control" id="dataNascimento" value="1990-03-15" disabled>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="email" value="joao.silva@email.com" disabled>
                                </div>
                                <div class="col-md-3">
                                    <label for="telefone" class="form-label">Telefone/WhatsApp *</label>
                                    <input type="tel" class="form-control" id="telefone" value="(28) 99999-9999" disabled>
                                </div>
                                <div class="col-md-3">
                                    <label for="cpf" class="form-label">CPF *</label>
                                    <input type="text" class="form-control" id="cpf" value="123.456.789-00" disabled readonly>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Endereço -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-geo-alt-fill"></i>
                                Localização
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="endereco">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-endereco">
                            <div class="row">
                                <div class="col-md-3">
                                    <label for="cep" class="form-label">CEP *</label>
                                    <input type="text" class="form-control" id="cep" value="29300-123" disabled>
                                </div>
                                <div class="col-md-6">
                                    <label for="endereco" class="form-label">Endereço *</label>
                                    <input type="text" class="form-control" id="endereco" value="Rua das Flores" disabled>
                                </div>
                                <div class="col-md-3">
                                    <label for="numero" class="form-label">Número</label>
                                    <input type="text" class="form-control" id="numero" value="123" disabled>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <label for="bairro" class="form-label">Bairro *</label>
                                    <input type="text" class="form-control" id="bairro" value="Centro" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="cidade" class="form-label">Cidade *</label>
                                    <input type="text" class="form-control" id="cidade" value="Cachoeiro de Itapemirim" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="estado" class="form-label">Estado *</label>
                                    <input type="text" class="form-control" id="estado" value="ES" disabled>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dados Profissionais -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-briefcase-fill"></i>
                                Informações Profissionais
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="profissionais">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-profissionais">
                            <div class="row">
                                <div class="col-md-4">
                                    <label for="experiencia" class="form-label">Anos de Experiência *</label>
                                    <select class="form-select" id="experiencia" disabled>
                                        <option value="3-5" selected>3 a 5 anos</option>
                                        <option value="0-1">Menos de 1 ano</option>
                                        <option value="1-2">1 a 2 anos</option>
                                        <option value="5-10">5 a 10 anos</option>
                                        <option value="10+">Mais de 10 anos</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="valorHora" class="form-label">Valor por Hora Desejado (R$) *</label>
                                    <input type="number" class="form-control" id="valorHora" value="30.00" min="15" step="0.50" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="escolaridade" class="form-label">Escolaridade *</label>
                                    <select class="form-select" id="escolaridade" disabled>
                                        <option value="tecnico" selected>Técnico</option>
                                        <option value="fundamental">Ensino Fundamental</option>
                                        <option value="medio">Ensino Médio</option>
                                        <option value="superior">Ensino Superior</option>
                                        <option value="pos">Pós-graduação</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apresentacao" class="form-label">Apresentação Pessoal *</label>
                                <textarea class="form-control" id="apresentacao" rows="4" maxlength="500" disabled>Profissional dedicado com mais de 5 anos de experiência no cuidado de idosos e pessoas com deficiência. Possuo formação técnica em enfermagem e especialização em cuidados geriátricos. Tenho paixão por ajudar as pessoas a manter sua dignidade e qualidade de vida, oferecendo cuidados personalizados e respeitosos.</textarea>
                                <div class="char-counter">
                                    <small class="form-text">348/500 caracteres</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Disponibilidade -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-clock-fill"></i>
                                Disponibilidade de Horários
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="disponibilidade">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-disponibilidade">
                            <div class="disponibilidade-grid">
                                <div class="periodo-item">
                                    <input type="checkbox" id="manha" value="manha" checked disabled>
                                    <label for="manha">
                                        <i class="bi bi-sunrise"></i>
                                        Manhã (6h às 12h)
                                    </label>
                                </div>
                                <div class="periodo-item">
                                    <input type="checkbox" id="tarde" value="tarde" checked disabled>
                                    <label for="tarde">
                                        <i class="bi bi-sun"></i>
                                        Tarde (12h às 18h)
                                    </label>
                                </div>
                                <div class="periodo-item">
                                    <input type="checkbox" id="noite" value="noite" disabled>
                                    <label for="noite">
                                        <i class="bi bi-moon"></i>
                                        Noite (18h às 24h)
                                    </label>
                                </div>
                                <div class="periodo-item">
                                    <input type="checkbox" id="madrugada" value="madrugada" disabled>
                                    <label for="madrugada">
                                        <i class="bi bi-moon-stars"></i>
                                        Madrugada (0h às 6h)
                                    </label>
                                </div>
                                <div class="periodo-item">
                                    <input type="checkbox" id="finsemana" value="finsemana" checked disabled>
                                    <label for="finsemana">
                                        <i class="bi bi-calendar-week"></i>
                                        Fins de Semana
                                    </label>
                                </div>
                                <div class="periodo-item">
                                    <input type="checkbox" id="feriados" value="feriados" disabled>
                                    <label for="feriados">
                                        <i class="bi bi-calendar-event"></i>
                                        Feriados
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Especialidades -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-heart-pulse-fill"></i>
                                Especialidades e Certificações
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="especialidades">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-especialidades">
                            <div class="especialidades-grid">
                                <div class="especialidade-item">
                                    <input type="checkbox" id="idosos" value="idosos" checked disabled>
                                    <label for="idosos">
                                        <i class="bi bi-person-hearts"></i>
                                        Cuidados com Idosos
                                    </label>
                                </div>
                                <div class="especialidade-item">
                                    <input type="checkbox" id="deficiencia" value="deficiencia" disabled>
                                    <label for="deficiencia">
                                        <i class="bi bi-universal-access"></i>
                                        Pessoas com Deficiência
                                    </label>
                                </div>
                                <div class="especialidade-item">
                                    <input type="checkbox" id="alzheimer" value="alzheimer" checked disabled>
                                    <label for="alzheimer">
                                        <i class="bi bi-brain"></i>
                                        Alzheimer/Demência
                                    </label>
                                </div>
                                <div class="especialidade-item">
                                    <input type="checkbox" id="medicamentos" value="medicamentos" checked disabled>
                                    <label for="medicamentos">
                                        <i class="bi bi-capsule"></i>
                                        Administração de Medicamentos
                                    </label>
                                </div>
                                <div class="especialidade-item">
                                    <input type="checkbox" id="primeiros-socorros" value="primeiros-socorros" checked disabled>
                                    <label for="primeiros-socorros">
                                        <i class="bi bi-heart-pulse"></i>
                                        Primeiros Socorros
                                    </label>
                                </div>
                                <div class="especialidade-item">
                                    <input type="checkbox" id="fisioterapia" value="fisioterapia" disabled>
                                    <label for="fisioterapia">
                                        <i class="bi bi-person-arms-up"></i>
                                        Apoio Fisioterápico
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="cursos" class="form-label">Cursos e Certificações</label>
                                <textarea class="form-control" id="cursos" rows="3" disabled>- Técnico em Enfermagem - SENAC (2018)
- Certificação em Cuidados Geriátricos - Hospital São Lucas (2020)
- Curso de Primeiros Socorros - Cruz Vermelha (2021)
- Capacitação em Alzheimer e Demência - Instituto Nacional de Envelhecimento (2022)</textarea>
                            </div>

                            <div class="documentos-list">
                                <label class="form-label">Documentos Anexados</label>
                                <div class="doc-item">
                                    <i class="bi bi-file-earmark-pdf text-danger"></i>
                                    <span>Certificado_Tecnico_Enfermagem.pdf</span>
                                    <button type="button" class="btn-remove-doc" disabled>
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                                <div class="doc-item">
                                    <i class="bi bi-file-earmark-pdf text-danger"></i>
                                    <span>Certificado_Primeiros_Socorros.pdf</span>
                                    <button type="button" class="btn-remove-doc" disabled>
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                                <div class="upload-area" style="display: none;" id="upload-area-especialidades">
                                    <i class="bi bi-file-earmark-plus"></i>
                                    <span>Adicionar novos certificados</span>
                                    <input type="file" id="novosCertificados" multiple accept=".pdf,.jpg,.jpeg,.png">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Agenda de Atendimentos -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3 class="section-title">
                                <i class="bi bi-calendar-check-fill"></i>
                                Agenda de Atendimentos
                            </h3>
                            <button type="button" class="btn-edit-section" data-section="agenda">
                                <i class="bi bi-pencil"></i> Editar
                            </button>
                        </div>
                        
                        <div class="section-content" id="section-agenda">
                            <div class="agenda-status">
                                <div class="status-item">
                                    <label class="form-check-label">
                                        <input type="radio" name="statusAgenda" value="disponivel" checked disabled>
                                        <span class="status-indicator disponivel"></span>
                                        Disponível para novos atendimentos
                                    </label>
                                </div>
                                <div class="status-item">
                                    <label class="form-check-label">
                                        <input type="radio" name="statusAgenda" value="parcial" disabled>
                                        <span class="status-indicator parcial"></span>
                                        Parcialmente disponível
                                    </label>
                                </div>
                                <div class="status-item">
                                    <label class="form-check-label">
                                        <input type="radio" name="statusAgenda" value="indisponivel" disabled>
                                        <span class="status-indicator indisponivel"></span>
                                        Indisponível temporariamente
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Botões de Ação -->
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success btn-lg" id="btnSalvar" style="display: none;">
                            <i class="bi bi-check-circle"></i>
                            Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmação -->
    <div class="modal fade" id="confirmModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirmar Alterações</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja salvar as alterações realizadas no seu perfil?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="confirmSave">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Controle de edição de seções
        let editingSections = new Set();
        let hasUnsavedChanges = false;

        document.querySelectorAll('.btn-edit-section').forEach(button => {
            button.addEventListener('click', function() {
                const section = this.getAttribute('data-section');
                toggleSectionEdit(section, this);
            });
        });

        function toggleSectionEdit(sectionName, button) {
            const sectionContent = document.getElementById(`section-${sectionName}`);
            const inputs = sectionContent.querySelectorAll('input, select, textarea');
            const isEditing = editingSections.has(sectionName);

            if (isEditing) {
                // Cancelar edição
                inputs.forEach(input => {
                    input.disabled = true;
                    if (input.type === 'checkbox') {
                        input.style.pointerEvents = 'none';
                    }
                });
                button.innerHTML = '<i class="bi bi-pencil"></i> Editar';
                button.classList.remove('editing');
                editingSections.delete(sectionName);
                
                // Esconder área de upload se existir
                const uploadArea = document.getElementById(`upload-area-${sectionName}`);
                if (uploadArea) {
                    uploadArea.style.display = 'none';
                }
                
                // Habilitar botões de remover documentos
                sectionContent.querySelectorAll('.btn-remove-doc').forEach(btn => {
                    btn.disabled = true;
                });
            } else {
                // Habilitar edição
                inputs.forEach(input => {
                    if (input.id !== 'cpf') { // CPF não pode ser editado
                        input.disabled = false;
                        if (input.type === 'checkbox') {
                            input.style.pointerEvents = 'auto';
                        }
                    }
                });
                button.innerHTML = '<i class="bi bi-x-circle"></i> Cancelar';
                button.classList.add('editing');
                editingSections.add(sectionName);
                
                // Mostrar área de upload se existir
                const uploadArea = document.getElementById(`upload-area-${sectionName}`);
                if (uploadArea) {
                    uploadArea.style.display = 'block';
                }
                
                // Desabilitar botões de remover documentos
                sectionContent.querySelectorAll('.btn-remove-doc').forEach(btn => {
                    btn.disabled = false;
                });
            }

            // Mostrar/esconder botão salvar
            updateSaveButton();
            hasUnsavedChanges = editingSections.size > 0;
        }

        function updateSaveButton() {
            const btnSalvar = document.getElementById('btnSalvar');
            if (editingSections.size > 0) {
                btnSalvar.style.display = 'inline-block';
            } else {
                btnSalvar.style.display = 'none';
            }
        }

        // Upload de nova foto de perfil
        document.querySelector('.profile-photo-container').addEventListener('click', function() {
            document.getElementById('novaFotoPerfil').click();
        });

        document.getElementById('novaFotoPerfil').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('fotoPerfilPreview').src = e.target.result;
                    hasUnsavedChanges = true;
                    updateSaveButton();
                };
                reader.readAsDataURL(file);
            }
        });

        // Máscaras de input
        document.getElementById('telefone').addEventListener('input', function(e) {
            if (!e.target.disabled) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length <= 11) {
                    value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                }
                e.target.value = value;
                hasUnsavedChanges = true;
            }
        });

        document.getElementById('cep').addEventListener('input', function(e) {
            if (!e.target.disabled) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
                e.target.value = value;
                hasUnsavedChanges = true;
            }
        });

        // Buscar endereço por CEP
        document.getElementById('cep').addEventListener('blur', function() {
            if (!this.disabled) {
                const cep = this.value.replace(/\D/g, '');
                if (cep.length === 8) {
                    fetch(`https://viacep.com.br/ws/${cep}/json/`)
                        .then(response => response.json())
                        .then(data => {
                            if (!data.erro) {
                                document.getElementById('endereco').value = data.logradouro;
                                document.getElementById('bairro').value = data.bairro;
                                document.getElementById('cidade').value = data.localidade;
                                document.getElementById('estado').value = data.uf;
                                hasUnsavedChanges = true;
                            }
                        })
                        .catch(error => console.error('Erro ao buscar CEP:', error));
                }
            }
        });

        // Contador de caracteres
        document.getElementById('apresentacao').addEventListener('input', function() {
            if (!this.disabled) {
                const maxLength = 500;
                const currentLength = this.value.length;
                const counter = this.parentNode.querySelector('.char-counter small');
                counter.textContent = `${currentLength}/${maxLength} caracteres`;
                hasUnsavedChanges = true;
            }
        });

        // Detectar mudanças nos inputs
        document.querySelectorAll('input, select, textarea').forEach(input => {
            input.addEventListener('change', function() {
                if (!this.disabled) {
                    hasUnsavedChanges = true;
                }
            });
        });

        // Submit do formulário
        document.getElementById('formEditarPerfil').addEventListener('submit', function(e) {
            e.preventDefault();
            if (hasUnsavedChanges) {
                const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
                modal.show();
            }
        });

        document.getElementById('confirmSave').addEventListener('click', function() {
            // Aqui seria implementada a lógica de salvamento
            console.log('Salvando alterações...');
            
                            // Simular salvamento
            setTimeout(() => {
                // Desabilitar todas as seções editadas
                editingSections.forEach(section => {
                    const button = document.querySelector(`[data-section="${section}"]`);
                    toggleSectionEdit(section, button);
                });
                
                hasUnsavedChanges = false;
                updateSaveButton();
                
                // Fechar modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('confirmModal'));
                modal.hide();
                
                // Mostrar mensagem de sucesso
                showToast('Perfil atualizado com sucesso!', 'success');
            }, 1000);
        });

        // Função para mostrar toast
        function showToast(message, type = 'info') {
            const toastContainer = document.querySelector('.toast-container') || createToastContainer();
            
            const toast = document.createElement('div');
            toast.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : 'info'} border-0`;
            toast.setAttribute('role', 'alert');
            
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="bi bi-${type === 'success' ? 'check-circle' : 'info-circle'} me-2"></i>
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            const bsToast = new bootstrap.Toast(toast, { delay: 4000 });
            bsToast.show();
            
            toast.addEventListener('hidden.bs.toast', () => {
                toast.remove();
            });
        }

        function createToastContainer() {
            const container = document.createElement('div');
            container.className = 'toast-container position-fixed top-0 end-0 p-3';
            container.style.zIndex = '9999';
            document.body.appendChild(container);
            return container;
        }

        // Aviso ao sair da página com mudanças não salvas
        window.addEventListener('beforeunload', function(e) {
            if (hasUnsavedChanges) {
                e.preventDefault();
                e.returnValue = '';
                return '';
            }
        });

        // Upload de novos certificados
        document.getElementById('novosCertificados')?.addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const docsList = document.querySelector('.documentos-list');
            
            files.forEach(file => {
                const docItem = document.createElement('div');
                docItem.className = 'doc-item new-doc';
                
                const fileIcon = file.type.includes('pdf') ? 'bi-file-earmark-pdf text-danger' : 'bi-file-earmark-image text-primary';
                
                docItem.innerHTML = `
                    <i class="bi ${fileIcon}"></i>
                    <span>${file.name}</span>
                    <button type="button" class="btn-remove-doc">
                        <i class="bi bi-trash"></i>
                    </button>
                `;
                
                // Inserir antes da área de upload
                const uploadArea = document.getElementById('upload-area-especialidades');
                docsList.insertBefore(docItem, uploadArea);
                
                // Adicionar evento de remoção
                docItem.querySelector('.btn-remove-doc').addEventListener('click', function() {
                    docItem.remove();
                    hasUnsavedChanges = true;
                });
                
                hasUnsavedChanges = true;
            });
        });

        // Remover documentos existentes
        document.querySelectorAll('.btn-remove-doc').forEach(button => {
            button.addEventListener('click', function() {
                if (!this.disabled) {
                    const docItem = this.closest('.doc-item');
                    if (confirm('Tem certeza que deseja remover este documento?')) {
                        docItem.style.opacity = '0.5';
                        docItem.style.textDecoration = 'line-through';
                        this.innerHTML = '<i class="bi bi-arrow-clockwise"></i>';
                        this.title = 'Restaurar documento';
                        hasUnsavedChanges = true;
                        
                        // Permitir restaurar
                        this.onclick = function() {
                            docItem.style.opacity = '1';
                            docItem.style.textDecoration = 'none';
                            this.innerHTML = '<i class="bi bi-trash"></i>';
                            this.title = 'Remover documento';
                        };
                    }
                }
            });
        });

        console.log('Página de edição de perfil carregada com sucesso!');
    </script>
    <link rel="stylesheet" href="/static/css/cadastro_cuidador.css">
{% endblock conteudo %}